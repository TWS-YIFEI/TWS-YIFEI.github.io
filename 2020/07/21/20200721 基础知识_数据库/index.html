<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'true', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-89376999-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-89376999-1');
</script>



  
  <title>基础知识_数据库 | YIFEI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="数据库笔记。">
<meta name="keywords" content="数据库,Summary,mysql">
<meta property="og:type" content="article">
<meta property="og:title" content="基础知识_数据库">
<meta property="og:url" content="http://taowusheng.cn/2020/07/21/20200721 基础知识_数据库/index.html">
<meta property="og:site_name" content="YIFEI">
<meta property="og:description" content="数据库笔记。">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2022-10-28T15:11:58.398Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="基础知识_数据库">
<meta name="twitter:description" content="数据库笔记。">
  
    <link rel="alternate" href="/atom.xml" title="YIFEI" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="/googleapis-fonts/fonts.css" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

  
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">YIFEI</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">每当我找到生命的意义，它就又变了...</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/links">Links</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://taowusheng.cn"></form>
      </div>
    </div>
  </div>
	
  <script>
    
    var number_of_banners = 8;
    var randnum = Math.floor(Math.random() * number_of_banners + 1);
    document.getElementById("banner").style.backgroundImage = "url(/css/images/banner" + randnum + ".jpg)";
    
</script>

</header>
      <div class="outer">
        <section id="main"><article id="post-20200721 基础知识_数据库" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/21/20200721 基础知识_数据库/" class="article-date">
  <time datetime="2020-07-21T00:00:01.000Z" itemprop="datePublished">2020-07-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Summary/">Summary</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      基础知识_数据库
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
		<!-- Table of Contents -->
		
		  <div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
			<ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#数据库原理"><span class="toc-number">1.</span> <span class="toc-text">数据库原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#数据库设计的三大范式"><span class="toc-number">1.1.</span> <span class="toc-text">数据库设计的三大范式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#不遵守三大范式会带来哪些问题"><span class="toc-number">1.2.</span> <span class="toc-text">不遵守三大范式会带来哪些问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#如何理解数据库索引"><span class="toc-number">1.3.</span> <span class="toc-text">如何理解数据库索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数据库事务以及四大特性"><span class="toc-number">1.4.</span> <span class="toc-text">数据库事务以及四大特性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#并发一致性问题"><span class="toc-number">1.5.</span> <span class="toc-text">并发一致性问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#事务的四种隔离级别"><span class="toc-number">1.6.</span> <span class="toc-text">事务的四种隔离级别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#两种封锁类型-读写锁和意向锁"><span class="toc-number">1.7.</span> <span class="toc-text">两种封锁类型:读写锁和意向锁</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#读写锁"><span class="toc-number">1.7.1.</span> <span class="toc-text">读写锁</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#意向锁"><span class="toc-number">1.7.2.</span> <span class="toc-text">意向锁</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#参考"><span class="toc-number">1.7.3.</span> <span class="toc-text">参考</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#隐式锁定-amp-显示锁定"><span class="toc-number">1.8.</span> <span class="toc-text">隐式锁定&amp;显示锁定</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#封锁协议"><span class="toc-number">1.9.</span> <span class="toc-text">封锁协议</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#一级封锁协议"><span class="toc-number">1.9.1.</span> <span class="toc-text">一级封锁协议</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#二级封锁协议"><span class="toc-number">1.9.2.</span> <span class="toc-text">二级封锁协议</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#三级封锁协议"><span class="toc-number">1.9.3.</span> <span class="toc-text">三级封锁协议</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#两阶段封锁协议"><span class="toc-number">1.9.4.</span> <span class="toc-text">两阶段封锁协议</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MVCC"><span class="toc-number">1.10.</span> <span class="toc-text">MVCC</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL语句"><span class="toc-number">2.</span> <span class="toc-text">SQL语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#数据库相关操作"><span class="toc-number">2.1.</span> <span class="toc-text">数据库相关操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数据表相关操作"><span class="toc-number">2.2.</span> <span class="toc-text">数据表相关操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#插入数据"><span class="toc-number">2.3.</span> <span class="toc-text">插入数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#查询数据"><span class="toc-number">2.4.</span> <span class="toc-text">查询数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#WHERE子句"><span class="toc-number">2.5.</span> <span class="toc-text">WHERE子句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#修改数据"><span class="toc-number">2.6.</span> <span class="toc-text">修改数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#删除数据"><span class="toc-number">2.7.</span> <span class="toc-text">删除数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LIKE子句"><span class="toc-number">2.8.</span> <span class="toc-text">LIKE子句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#UNION"><span class="toc-number">2.9.</span> <span class="toc-text">UNION</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#排序"><span class="toc-number">2.10.</span> <span class="toc-text">排序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#分组"><span class="toc-number">2.11.</span> <span class="toc-text">分组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#连接"><span class="toc-number">2.12.</span> <span class="toc-text">连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NULL值判断"><span class="toc-number">2.13.</span> <span class="toc-text">NULL值判断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#正则表达式"><span class="toc-number">2.14.</span> <span class="toc-text">正则表达式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#事务"><span class="toc-number">2.15.</span> <span class="toc-text">事务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ALTER-命令"><span class="toc-number">2.16.</span> <span class="toc-text">ALTER 命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#索引"><span class="toc-number">2.17.</span> <span class="toc-text">索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#临时表"><span class="toc-number">2.18.</span> <span class="toc-text">临时表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#复制表"><span class="toc-number">2.19.</span> <span class="toc-text">复制表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#获取服务器原数据"><span class="toc-number">2.20.</span> <span class="toc-text">获取服务器原数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#删除重复数据"><span class="toc-number">2.21.</span> <span class="toc-text">删除重复数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#导入导出数据"><span class="toc-number">2.22.</span> <span class="toc-text">导入导出数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LeetCode题解"><span class="toc-number">3.</span> <span class="toc-text">LeetCode题解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mysql"><span class="toc-number">4.</span> <span class="toc-text">Mysql</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#b树与b-树对比"><span class="toc-number">4.1.</span> <span class="toc-text">b树与b+树对比</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#为什么数据库普遍不用红黑树作索引"><span class="toc-number">4.2.</span> <span class="toc-text">为什么数据库普遍不用红黑树作索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#为什么数据库一般不用hash表作索引"><span class="toc-number">4.3.</span> <span class="toc-text">为什么数据库一般不用hash表作索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#STL为什么用红黑树实现map、set，不用平衡二叉树。"><span class="toc-number">4.4.</span> <span class="toc-text">STL为什么用红黑树实现map、set，不用平衡二叉树。</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参考-1"><span class="toc-number">5.</span> <span class="toc-text">参考</span></a></li></ol>
		  </div>
		
        <p>数据库笔记。<br><a id="more"></a></p>
<h3 id="数据库原理"><a href="#数据库原理" class="headerlink" title="数据库原理"></a>数据库原理</h3><h4 id="数据库设计的三大范式"><a href="#数据库设计的三大范式" class="headerlink" title="数据库设计的三大范式"></a>数据库设计的三大范式</h4><ul>
<li>第一范式：确保每列保持原子性。比如存储地址时，如果省市区都放到一列里，如果需要读取省份时，就比较麻烦了，这样就不符合原子性了。所以应当把省份、市、区、详细地址分别放到不同的列中。</li>
<li>第二范式：确保每列数据完全依赖于主键，而不是依赖主关键字的一部分。如果有两个联合主键a和b，又有数据列c依赖a，d依赖b，就应该把他们分成两个表。</li>
<li>第三范式：除主键外的其他列之间不应该有依赖关系。</li>
<li>每个范式都建立在前一范式的基础上。在实际应用中不一定要完全遵守三大范式，虽然可能会有数据冗余，但是能提高查询效率。</li>
</ul>
<h4 id="不遵守三大范式会带来哪些问题"><a href="#不遵守三大范式会带来哪些问题" class="headerlink" title="不遵守三大范式会带来哪些问题"></a>不遵守三大范式会带来哪些问题</h4><table>
<thead>
<tr>
<th style="text-align:center">学号</th>
<th style="text-align:center">姓名</th>
<th style="text-align:center">班级</th>
<th style="text-align:center">班主任</th>
<th style="text-align:center">课程</th>
<th style="text-align:center">分数</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">001</td>
<td style="text-align:center">萧炎</td>
<td style="text-align:center">一班</td>
<td style="text-align:center">药老</td>
<td style="text-align:center">青莲地心火</td>
<td style="text-align:center">100</td>
</tr>
<tr>
<td style="text-align:center">001</td>
<td style="text-align:center">萧炎</td>
<td style="text-align:center">一班</td>
<td style="text-align:center">药老</td>
<td style="text-align:center">净莲妖火</td>
<td style="text-align:center">100</td>
</tr>
<tr>
<td style="text-align:center">002</td>
<td style="text-align:center">林动</td>
<td style="text-align:center">二班</td>
<td style="text-align:center">天蚕土豆</td>
<td style="text-align:center">通背拳</td>
<td style="text-align:center">100</td>
</tr>
<tr>
<td style="text-align:center">002</td>
<td style="text-align:center">林动</td>
<td style="text-align:center">二班</td>
<td style="text-align:center">天蚕土豆</td>
<td style="text-align:center">大荒囚天指</td>
<td style="text-align:center">100</td>
</tr>
<tr>
<td style="text-align:center">003</td>
<td style="text-align:center">谢文东</td>
<td style="text-align:center">三班</td>
<td style="text-align:center">六道</td>
<td style="text-align:center">坏蛋是怎样炼成的</td>
<td style="text-align:center">100</td>
</tr>
</tbody>
</table>
<p>如上表格:</p>
<ul>
<li>冗余数据。班级、班主任都因为课程出现数据冗余。</li>
<li>插入异常。如果增加一个未选课的学生，就无法插入数据。</li>
<li>删除异常。如果撤销一个班主任，会丢失学生的信息。</li>
<li>修改异常。修改一个学生的班主任时，会有另一条记录未被修改。</li>
</ul>
<h4 id="如何理解数据库索引"><a href="#如何理解数据库索引" class="headerlink" title="如何理解数据库索引"></a>如何理解数据库索引</h4><ul>
<li><a href="https://blog.tankery.me/development/why-we-need-indexes-for-database" target="_blank" rel="noopener">https://blog.tankery.me/development/why-we-need-indexes-for-database</a></li>
<li><a href="https://blog.csdn.net/weiliangliang111/article/details/51333169" target="_blank" rel="noopener">https://blog.csdn.net/weiliangliang111/article/details/51333169</a></li>
</ul>
<h4 id="数据库事务以及四大特性"><a href="#数据库事务以及四大特性" class="headerlink" title="数据库事务以及四大特性"></a>数据库事务以及四大特性</h4><p>1.事务</p>
<ul>
<li>事务是满足ACID特性的一组sql操作。</li>
</ul>
<p>2.事务四大特性</p>
<ul>
<li>原子性（atomicity）：一个事务必须视为一个不可分割的最小工作单元，整个事务中的所有操作要么全部提交成功，要么全部失败回滚，对于一个事务来说，不可能只执行其中的一部分操作，这就是事务的原子性。</li>
<li>一致性（consistency）：数据库总数从一个一致性的状态转换到另一个一致性的状态，也就是说一个事务执行之前和执行之后都必须处于一致性状态。(所谓一致性可以说是一种正确地状态，所谓正确，就是满足一定的约束条件)</li>
<li>隔离性（isolation）：一个事务所做的修改在最终提交以前，对其他事务是不可见的。</li>
<li>持久性（durability）：一旦事务提交，则其所做的修改就会永久保存到数据库中。此时即使系统崩溃，修改的数据也不会丢失。</li>
</ul>
<p>3.四个特性的关系</p>
<ul>
<li>在无并发的情况下，保证原子性就能实现一致性。</li>
<li>有并发时保证原子性和隔离性才能实现一致性。</li>
<li>实现一致性才能保证结果的正确。</li>
<li>持久性保证数据库崩溃后数据不会丢失。</li>
</ul>
<h4 id="并发一致性问题"><a href="#并发一致性问题" class="headerlink" title="并发一致性问题"></a>并发一致性问题</h4><p>1.1第一类丢失更新(回滚导致丢失)。T1回滚导致T2提交的修改丢失了。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">T1        T2</span><br><span class="line">修改var</span><br><span class="line">          修改var</span><br><span class="line">回滚</span><br></pre></td></tr></table></figure>
<p>1.2第二类丢失更新(覆盖导致丢失)。T1对var的修改被T2提交的修改覆盖了，这是不可重复读的一种特殊情况。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">T1        T2</span><br><span class="line">修改var    </span><br><span class="line">          修改var</span><br><span class="line">读取var</span><br></pre></td></tr></table></figure>
<p>2.脏读，又称无效数据读出。一个事务读取另外一个事务还没有提交的数据叫脏读。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">T1        T2</span><br><span class="line">修改var    </span><br><span class="line">          读取var</span><br><span class="line">回滚</span><br></pre></td></tr></table></figure>
<p>3.不可重复读，一个事务读取了另一个事务提交的数据。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">T1        T2</span><br><span class="line">读取var    </span><br><span class="line">          修改var</span><br><span class="line">读取var</span><br></pre></td></tr></table></figure></p>
<p>4.幻读，读取到了不存在的数据。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">T1            T2</span><br><span class="line">范围读取数据    </span><br><span class="line">              插入一条数据</span><br><span class="line">范围读取数据</span><br></pre></td></tr></table></figure>
<ul>
<li>不可重复读跟幻读有点像，区别在于不可重复读是读取到了另一个事务的update操作，幻读是读取到了另一个事务的insert操作。</li>
</ul>
<h4 id="事务的四种隔离级别"><a href="#事务的四种隔离级别" class="headerlink" title="事务的四种隔离级别"></a>事务的四种隔离级别</h4><p>数据库事务的隔离级别有4个，依次递增：</p>
<ul>
<li>Read uncommitted，未提交读表示在一个事务中可以读取另一个事务未提交的数据，存在脏读、不可重复读、幻读的问题。</li>
<li>Read committed，提交读表示一个事务中可以读取另一事务已提交的数据，存在不可重复读、幻读的问题。</li>
<li>Repeatable read，可重复读保证一个事务中多次读取的结果是相同的，还存在幻读的问题。</li>
<li>Serializable，强制事务串行化，一般不用这个隔离级别。</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">隔离级别</th>
<th style="text-align:center">脏读</th>
<th style="text-align:center">不可重复读</th>
<th style="text-align:center">幻影读</th>
<th style="text-align:center">丢失更新</th>
<th style="text-align:center">第二类丢失更新</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">未提交读</td>
<td style="text-align:center">√</td>
<td style="text-align:center">√</td>
<td style="text-align:center">√</td>
<td style="text-align:center">x</td>
<td style="text-align:center">x</td>
</tr>
<tr>
<td style="text-align:center">提交读</td>
<td style="text-align:center">×</td>
<td style="text-align:center">√</td>
<td style="text-align:center">√</td>
<td style="text-align:center">x</td>
<td style="text-align:center">x</td>
</tr>
<tr>
<td style="text-align:center">可重复读</td>
<td style="text-align:center">×</td>
<td style="text-align:center">×</td>
<td style="text-align:center">√</td>
<td style="text-align:center">x</td>
<td style="text-align:center">x</td>
</tr>
<tr>
<td style="text-align:center">可串行化</td>
<td style="text-align:center">×</td>
<td style="text-align:center">×</td>
<td style="text-align:center">×</td>
<td style="text-align:center">x</td>
<td style="text-align:center">x</td>
</tr>
</tbody>
</table>
<p>参考：<a href="https://blog.kazge.com/数据库/2011/10/25/e4-b8-89-e7-ba-a7-e5-b0-81-e9-94-81-e5-8d-8f-e8-ae-ae-e4-b8-a4-e6-ae-b5-e9-94-81-e4-bb-a5-e5-8f-8a-e9-9a-94-e7-a6-bb-e7-ba-a7-e5-88-ab/" target="_blank" rel="noopener">三级封锁协议两段锁以及隔离级别</a></p>
<p>PS:我的理解是未提交读采用一级封锁协议就已经解决了丢失更新问题，但是网上很多人的总结”提交读”级别还存在第二类丢失更新问题？</p>
<h4 id="两种封锁类型-读写锁和意向锁"><a href="#两种封锁类型-读写锁和意向锁" class="headerlink" title="两种封锁类型:读写锁和意向锁"></a>两种封锁类型:读写锁和意向锁</h4><p>Mysql提供两种封锁粒度，分别是行级锁和表级锁。</p>
<p>当访问数据的时候，尽量加锁小的范围可以减少性能的损耗，所以加锁的时候需要在锁开销和并发程度之间做一个平衡。</p>
<h5 id="读写锁"><a href="#读写锁" class="headerlink" title="读写锁"></a>读写锁</h5><ul>
<li>读锁又叫共享锁(Shared Lock,简称S锁)，可以加在表上，也可以加在行上。</li>
<li>写锁又叫排它锁(Exclusive Lock,简称X锁)，可以加在表上，也可以加在行上。</li>
</ul>
<p>如果事务T1对数据A加了共享锁，T2可以对数据A再加共享锁，但是不能再加排他锁。</p>
<p>如果事务T2对数据A加了排它锁，T2不可以再加共享锁或排它锁。</p>
<p>两者的兼容关系如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">-</th>
<th style="text-align:center">S</th>
<th style="text-align:center">X</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">S</td>
<td style="text-align:center">√</td>
<td style="text-align:center">×</td>
</tr>
<tr>
<td style="text-align:center">X</td>
<td style="text-align:center">×</td>
<td style="text-align:center">×</td>
</tr>
</tbody>
</table>
<h5 id="意向锁"><a href="#意向锁" class="headerlink" title="意向锁"></a>意向锁</h5><p>1.如果事务T1对表的第5行加了排它锁，T2又想对表加排它锁/共享锁，T2需要检查两件事：</p>
<ul>
<li>表上是否有表级的排它锁。</li>
<li>表中某一行是否加了排它锁。</li>
</ul>
<p>在判断第二点的时候，需要遍历表中的每一行才能判断，这样的开销太大了。如果能给<strong>表加一个标志</strong>，用来标志表内某一行是否有排它锁。这样就产生了意向锁。</p>
<p>2.意向锁分为以下两种：</p>
<ul>
<li>意向共享锁(Intention Shared Lock,简称IS)，只能是表锁。</li>
<li>意向排他锁(Intention Exclusive Lock,简称IX)，只能是表锁。</li>
</ul>
<p>事务T在获取<strong>某行</strong>的S锁之前，需要先获取<strong>该表</strong>的IS锁或者IX锁。</p>
<p>事务T在获取<strong>某行</strong>的X锁之前，需要先获取<strong>该表</strong>的IX锁。</p>
<p>PS：S和X是我们要手动去加的，IS和IX是数据库根据我们的操作自动去加的。</p>
<p>3.意向锁只是一个标志，表示表上已经加了或即将要加共享锁/排它锁，所以<strong>意向锁之间相互兼容</strong>:</p>
<table>
<thead>
<tr>
<th style="text-align:center">-</th>
<th style="text-align:center">IS</th>
<th style="text-align:center">IX</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">IS</td>
<td style="text-align:center">√</td>
<td style="text-align:center">√</td>
</tr>
<tr>
<td style="text-align:center">IX</td>
<td style="text-align:center">√</td>
<td style="text-align:center">√</td>
</tr>
</tbody>
</table>
<p>4.意向锁和<strong>表级的</strong>共享锁排它锁之间的兼容关系如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">-</th>
<th style="text-align:center">IS</th>
<th style="text-align:center">IX</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">S</td>
<td style="text-align:center">√</td>
<td style="text-align:center">x</td>
</tr>
<tr>
<td style="text-align:center">X</td>
<td style="text-align:center">x</td>
<td style="text-align:center">x</td>
</tr>
</tbody>
</table>
<h5 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h5><ul>
<li><a href="https://www.zhihu.com/question/51513268" target="_blank" rel="noopener">InnoDB 的意向锁有什么作用？</a></li>
<li><a href="https://juejin.im/post/6844903666332368909" target="_blank" rel="noopener">详解 MySql InnoDB 中意向锁的作用</a></li>
</ul>
<h4 id="隐式锁定-amp-显示锁定"><a href="#隐式锁定-amp-显示锁定" class="headerlink" title="隐式锁定&amp;显示锁定"></a>隐式锁定&amp;显示锁定</h4><p>InnoDB会根据隔离级别在合适的时候进行加锁和解锁，这是隐式锁定。我们也可以通过Sql语句显示加锁。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT ... LOCK IN SHARE MODE;  #添加共享锁</span><br><span class="line">SELECT ... FOR UPDATE;	#添加排它锁</span><br></pre></td></tr></table></figure>
<h4 id="封锁协议"><a href="#封锁协议" class="headerlink" title="封锁协议"></a>封锁协议</h4><p>了解读写锁和意向锁的概念后，何时加锁何时解锁还是个问题。有三级封锁协议，分别对应几种隔离级别。</p>
<h5 id="一级封锁协议"><a href="#一级封锁协议" class="headerlink" title="一级封锁协议"></a>一级封锁协议</h5><ul>
<li>事务T修改数据时要加X锁，直到<strong>事务T结束</strong>才释放锁。</li>
</ul>
<p>一级封锁协议要求修改数据时必须要加锁，能够避免丢失修改问题，对应”未提交读”隔离级别。</p>
<table>
<thead>
<tr>
<th style="text-align:center">T1</th>
<th style="text-align:center">T2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">lockX(var)</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">修改var</td>
<td style="text-align:center">lockX(var)</td>
</tr>
<tr>
<td style="text-align:center">提交</td>
<td style="text-align:center">阻塞</td>
</tr>
<tr>
<td style="text-align:center">unlockX(var)</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">获得锁</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">修改var</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">提交</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">unlockX(var)</td>
</tr>
</tbody>
</table>
<h5 id="二级封锁协议"><a href="#二级封锁协议" class="headerlink" title="二级封锁协议"></a>二级封锁协议</h5><p>二级封锁协议要求在一级封锁协议基础上再加一条：</p>
<ul>
<li>事务T读取数据时要加S锁，<strong>读取结束</strong>释放锁。</li>
</ul>
<p>这样事务T1在写数据时已经加了X锁，事务T2想要读取数据在加S锁时会阻塞，能够避免脏读问题。这对应了“提交读”的隔离级别。</p>
<table>
<thead>
<tr>
<th style="text-align:center">T1</th>
<th style="text-align:center">T2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">lockX(var)</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">修改var</td>
<td style="text-align:center">lockS(var)</td>
</tr>
<tr>
<td style="text-align:center">回滚</td>
<td style="text-align:center">阻塞</td>
</tr>
<tr>
<td style="text-align:center">unlockX(var)</td>
<td style="text-align:center">…</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">获得锁</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">读取var</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">提交</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">unlockS(var)</td>
</tr>
</tbody>
</table>
<h5 id="三级封锁协议"><a href="#三级封锁协议" class="headerlink" title="三级封锁协议"></a>三级封锁协议</h5><p>三级封锁协议要求在一级封锁协议的基础上再加一条：</p>
<ul>
<li>事务T读取数据时要加S锁，直到<strong>事务结束</strong>释放S锁。</li>
</ul>
<p>二级封锁协议在读取结束后就释放S锁，还会存在不可重复读问题：事务T2对数据加S锁，读取结束释放S锁。事务T1加X锁修改数据，T1结束释放X锁。事务T2又加S锁重复读取数据，这时T2在一个事务里就两次读到了不同的数据。</p>
<p>三级封锁协议要求在事务结束后释放S锁，就避免了读数据过程中其他事务来修改数据。解决了不可重复读的问题，对应”可重复读”隔离级别。</p>
<p>疑问：三级封锁协议并不能阻止幻读，修改的不能再被读取，但是新增(删除)的记录数可以统计。为什么三级封锁协议不能阻止幻读，insert和delete操作是如何加锁的？</p>
<table>
<thead>
<tr>
<th style="text-align:center">T1</th>
<th style="text-align:center">T2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">lockS(var)</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">读取var</td>
</tr>
<tr>
<td style="text-align:center">lockX(var)</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">阻塞</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">读取var</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">提交</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">unlockS(var)</td>
</tr>
<tr>
<td style="text-align:center">获得锁</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">修改var</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">提交</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">unlockX(var)</td>
</tr>
</tbody>
</table>
<h5 id="两阶段封锁协议"><a href="#两阶段封锁协议" class="headerlink" title="两阶段封锁协议"></a>两阶段封锁协议</h5><p>该协议要求一个事务分为加锁(生长阶段)和解锁(衰退阶段)两个阶段，也就是在一个事务里，任何一个加锁都在解锁前面。</p>
<p>事务满足两阶段封锁协议&gt;&gt;串行化调度，反之就不一定了。该协议可以满足”可串行化”隔离级别。</p>
<h4 id="MVCC"><a href="#MVCC" class="headerlink" title="MVCC"></a>MVCC</h4><p>xxx</p>
<h3 id="SQL语句"><a href="#SQL语句" class="headerlink" title="SQL语句"></a>SQL语句</h3><h4 id="数据库相关操作"><a href="#数据库相关操作" class="headerlink" title="数据库相关操作"></a>数据库相关操作</h4><ul>
<li><p>判断mysql是否启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep mysqld</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动mysql服务器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/bin</span><br><span class="line">./mysqld_safe &amp;</span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭mysql服务器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/bin</span><br><span class="line">./mysqladmin -u root -p shutdown</span><br><span class="line">Enter password: ******</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动mysql终端</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure>
</li>
<li><p>退出mysql终端</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;exit</span><br></pre></td></tr></table></figure>
<ul>
<li>创建数据库</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#sql语句创建</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> 库名;</span><br><span class="line">#命令行直接创建</span><br><span class="line">mysqladmin -u root -p <span class="keyword">create</span> 库名</span><br></pre></td></tr></table></figure>
<ul>
<li>删除数据库</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">DATABASE</span> 库名;</span><br><span class="line">#命令行删除</span><br><span class="line">mysqladmin -u root -p <span class="keyword">drop</span> 库名;</span><br></pre></td></tr></table></figure>
<ul>
<li>打印所有数据库名</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">DATABASES</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>选择数据库</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">USE</span> 库名;</span><br></pre></td></tr></table></figure>
<h4 id="数据表相关操作"><a href="#数据表相关操作" class="headerlink" title="数据表相关操作"></a>数据表相关操作</h4><ul>
<li>查看、修改表属性</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">TABLE</span> <span class="keyword">STATUS</span> <span class="keyword">LIKE</span> <span class="string">'表名'</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>创建表</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> <span class="string">`test_tbl`</span>(</span><br><span class="line">   <span class="string">`test_id`</span> <span class="built_in">INT</span> <span class="keyword">UNSIGNED</span> AUTO_INCREMENT,</span><br><span class="line">   <span class="string">`test_title`</span> <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">   <span class="string">`test_author`</span> <span class="built_in">VARCHAR</span>(<span class="number">40</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">   <span class="string">`submission_date`</span> <span class="built_in">DATE</span>,</span><br><span class="line">   PRIMARY <span class="keyword">KEY</span> ( <span class="string">`test_id`</span> )</span><br><span class="line">)<span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line">============================================================</span><br><span class="line">如果你不想字段为 **NULL** 可以设置字段的属性为 **NOT NULL**， 在操作数据库时如果输入该字段的数据为**NULL** ，就会报错。</span><br><span class="line">AUTO_INCREMENT定义列为自增的属性，一般用于主键，数值会自动加1。</span><br><span class="line">PRIMARY KEY关键字用于定义列为主键。 您可以使用多列来定义主键，列间以逗号分隔。</span><br><span class="line">ENGINE 设置存储引擎，CHARSET 设置编码。</span><br></pre></td></tr></table></figure>
<ul>
<li>查看表的字段</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">COLUMNS</span> <span class="keyword">FROM</span> <span class="keyword">test</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>删除表</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> 表名;</span><br></pre></td></tr></table></figure>
<h4 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_tbl</span><br><span class="line">(test_title,test_author,submission_date)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">(<span class="string">"study sql"</span>,<span class="string">"YIFEI"</span>,<span class="keyword">NOW</span>());</span><br></pre></td></tr></table></figure>
<h4 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#SELECT语法</span><br><span class="line"><span class="keyword">SELECT</span> column_name,column_name</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line">[<span class="keyword">WHERE</span> Clause]</span><br><span class="line">[<span class="keyword">LIMIT</span> N][ <span class="keyword">OFFSET</span> M]</span><br><span class="line">============================================</span><br><span class="line">查询语句中你可以使用一个或者多个表，表之间使用逗号(,)分割，并使用<span class="keyword">WHERE</span>语句来设定查询条件。</span><br><span class="line"><span class="keyword">SELECT</span> 命令可以读取一条或者多条记录。</span><br><span class="line">你可以使用星号（*）来代替其他字段，<span class="keyword">SELECT</span>语句会返回表的所有字段数据</span><br><span class="line">你可以使用 <span class="keyword">WHERE</span> 语句来包含任何条件。</span><br><span class="line">你可以使用 <span class="keyword">LIMIT</span> 属性来设定返回的记录数。</span><br><span class="line">你可以通过<span class="keyword">OFFSET</span>指定<span class="keyword">SELECT</span>语句开始查询的数据偏移量。默认情况下偏移量为<span class="number">0</span>。</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> 表名;</span><br><span class="line"><span class="keyword">SELECT</span> column1,column2 <span class="keyword">FROM</span> 表名;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> column1,coulumn2 <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure>
<h4 id="WHERE子句"><a href="#WHERE子句" class="headerlink" title="WHERE子句"></a>WHERE子句</h4><ul>
<li><p>单表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> test_author,test_id <span class="keyword">FROM</span> test_tbl</span><br><span class="line"><span class="keyword">WHERE</span> <span class="built_in">BINARY</span> test_title=<span class="string">'study php'</span> <span class="keyword">AND</span> </span><br><span class="line">	<span class="built_in">BINARY</span> test_author=<span class="string">'YIFEI'</span></span><br><span class="line">=======================================</span><br><span class="line">多个条件用<span class="keyword">AND</span>、<span class="keyword">OR</span>连接。</span><br><span class="line">=检测是否相等，&lt;&gt;、!=检测不等，其他还有&lt;=、&gt;=。</span><br><span class="line"><span class="built_in">BINARY</span>表示区分大小写。</span><br><span class="line"><span class="keyword">WHERE</span>也可以用于<span class="keyword">DELETE</span> 或者 <span class="keyword">UPDATE</span>中。</span><br></pre></td></tr></table></figure>
</li>
<li><p>多表</p>
</li>
</ul>
<h4 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> test_tbl </span><br><span class="line"><span class="keyword">SET</span> test_title=<span class="string">'study cpp'</span>,test_author=<span class="string">'tws'</span></span><br><span class="line"><span class="keyword">WHERE</span> test_id=<span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<h4 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> test_tbl <span class="keyword">WHERE</span> test_id=<span class="number">3</span>;</span><br></pre></td></tr></table></figure>
<h4 id="LIKE子句"><a href="#LIKE子句" class="headerlink" title="LIKE子句"></a>LIKE子句</h4><ul>
<li>使用%匹配任意字符</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> test_2 <span class="keyword">WHERE</span> submission_date <span class="keyword">LIKE</span> <span class="string">"%08-26"</span>;</span><br></pre></td></tr></table></figure>
<h4 id="UNION"><a href="#UNION" class="headerlink" title="UNION"></a>UNION</h4><ul>
<li>联合查询</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> submission_date <span class="keyword">FROM</span> test_2</span><br><span class="line"><span class="keyword">UNION</span> all</span><br><span class="line"><span class="keyword">SELECT</span> submission_date <span class="keyword">FROM</span> test_tbl</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> submission_date；</span><br><span class="line">====================================</span><br><span class="line">all是显示所有数据，默认为<span class="keyword">distinct</span>去重。</span><br><span class="line">两个<span class="keyword">select</span>查询的列数应当相同。</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> submission_date是按照该列排序。</span><br></pre></td></tr></table></figure>
<ul>
<li>带有WHERE的联合查询</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> country, <span class="keyword">name</span> <span class="keyword">FROM</span> Websites</span><br><span class="line"><span class="keyword">WHERE</span> country=<span class="string">'CN'</span></span><br><span class="line"><span class="keyword">UNION</span> ALL</span><br><span class="line"><span class="keyword">SELECT</span> country, app_name <span class="keyword">FROM</span> apps</span><br><span class="line"><span class="keyword">WHERE</span> country=<span class="string">'CN'</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> country;</span><br></pre></td></tr></table></figure>
<h4 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h4><ul>
<li>升序排列</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> test_tbl <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">name</span> <span class="keyword">DESC</span>,<span class="built_in">date</span> <span class="keyword">ASC</span>;</span><br><span class="line">===========================================================</span><br><span class="line">ASC升序排列，DESC为降序排列。</span><br><span class="line">如果排序列为汉字，想要按照拼音排序:ORDER BY CONVERT(title using gbk);</span><br></pre></td></tr></table></figure>
<h4 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h4><ul>
<li>分组并统计个数</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span>,<span class="keyword">COUNT</span>(*) <span class="keyword">FROM</span> employee_tbl <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">name</span>;</span><br><span class="line">======================================================</span><br><span class="line">按照名字分组。</span><br><span class="line">count(*)统计每类的数量。</span><br></pre></td></tr></table></figure>
<ul>
<li>使用WITH ROLLUP，在group by的结果之上再统计。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">coalesce</span>(<span class="keyword">name</span>, <span class="string">'总数'</span>), <span class="keyword">SUM</span>(singin) <span class="keyword">as</span> singin_count <span class="keyword">FROM</span>  employee_tbl <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">name</span> <span class="keyword">WITH</span> <span class="keyword">ROLLUP</span>;</span><br><span class="line">+<span class="comment">--------------------------+--------------+</span></span><br><span class="line">| coalesce(name, '总数') | singin_count |</span><br><span class="line">+<span class="comment">--------------------------+--------------+</span></span><br><span class="line">| 小丽                   |            2 |</span><br><span class="line">| 小明                   |            7 |</span><br><span class="line">| 小王                   |            7 |</span><br><span class="line">| 总数                   |           16 |</span><br><span class="line">+<span class="comment">--------------------------+--------------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line">==================================================</span><br><span class="line"><span class="keyword">coalesce</span>(a,b,c)如果a!=<span class="literal">null</span>就使用a作为该列名称，如上如果<span class="keyword">name</span>为空，就使用<span class="string">"总数"</span>作列名。</span><br><span class="line"><span class="keyword">ifnull</span>(a,b)跟<span class="keyword">coalesce</span>一样的效果。</span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">ROLLUP</span>之后可以对分组结果再统计<span class="keyword">SUM</span>(singin)。</span><br><span class="line"><span class="keyword">SUM</span>之外还有<span class="keyword">AVG</span>、<span class="keyword">COUNT</span>等。</span><br></pre></td></tr></table></figure>
<h4 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h4><p><strong>内连接</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.runoob_id,a.runoob_title,b.runoob_author </span><br><span class="line"><span class="keyword">FROM</span> runoob_2 <span class="keyword">AS</span> a <span class="keyword">INNER</span> <span class="keyword">JOIN</span> runoob_tbl <span class="keyword">AS</span> b </span><br><span class="line"><span class="keyword">ON</span> <span class="built_in">BINARY</span> a.runoob_author=b.runoob_author;</span><br></pre></td></tr></table></figure>
<p>内连接是取两表的交集，上面语句等价于以下WHERE语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.runoob_id,a.runoob_title,b.runoob_author </span><br><span class="line"><span class="keyword">FROM</span> runoob_2 <span class="keyword">AS</span> a,runoob_tbl <span class="keyword">AS</span> b </span><br><span class="line"><span class="keyword">WHERE</span> <span class="built_in">BINARY</span> a.runoob_author=b.runoob_author;</span><br></pre></td></tr></table></figure>
<p><strong>左连接</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.runoob_id,a.runoob_title,b.runoob_author </span><br><span class="line"><span class="keyword">FROM</span> runoob_2 <span class="keyword">AS</span> a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> runoob_tbl <span class="keyword">AS</span> b </span><br><span class="line"><span class="keyword">ON</span> <span class="built_in">BINARY</span> a.runoob_author=b.runoob_author;</span><br></pre></td></tr></table></figure>
<p>左连接会选取左表全部，输出右表满足要求的。</p>
<p><strong>右连接</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.runoob_id,a.runoob_title,b.runoob_author </span><br><span class="line"><span class="keyword">FROM</span> runoob_2 <span class="keyword">AS</span> a <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> runoob_tbl <span class="keyword">AS</span> b </span><br><span class="line"><span class="keyword">ON</span> <span class="built_in">BINARY</span> a.runoob_author=b.runoob_author;</span><br></pre></td></tr></table></figure>
<h4 id="NULL值判断"><a href="#NULL值判断" class="headerlink" title="NULL值判断"></a>NULL值判断</h4><p>在WHERE子句中判断某值为空时不能<strong>WHERE name=null</strong>，应当使用如下方式：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">test</span> <span class="keyword">WHERE</span> <span class="keyword">name</span> <span class="keyword">IS</span> <span class="literal">NULL</span>;</span><br><span class="line">=============================================</span><br><span class="line">**IS NULL:** 当列的值是 NULL,此运算符返回 true。</span><br><span class="line">**IS NOT NULL:** 当列的值不为 NULL, 运算符返回 true。</span><br><span class="line">**&lt;=&gt;:** 比较操作符（不同于 = 运算符），当比较的的两个值相等或者都为 NULL 时返回 true。</span><br></pre></td></tr></table></figure>
<h4 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> runoob_2 <span class="keyword">WHERE</span> runoob_author REGEXP <span class="string">'^y'</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center">模式</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">^</td>
<td style="text-align:center">匹配输入字符串的开始位置。如果设置了 RegExp 对象的 Multiline 属性，^ 也匹配 ‘\n’ 或 ‘\r’ 之后的位置。</td>
</tr>
<tr>
<td style="text-align:center">$</td>
<td style="text-align:center">匹配输入字符串的结束位置。如果设置了RegExp 对象的 Multiline 属性，$ 也匹配 ‘\n’ 或 ‘\r’ 之前的位置。</td>
</tr>
<tr>
<td style="text-align:center">.</td>
<td style="text-align:center">匹配除 “\n” 之外的任何单个字符。要匹配包括 ‘\n’ 在内的任何字符，请使用像 ‘[.\n]’ 的模式。</td>
</tr>
<tr>
<td style="text-align:center">[…]</td>
<td style="text-align:center">字符集合。匹配所包含的任意一个字符。例如， ‘[abc]’ 可以匹配 “plain” 中的 ‘a’。</td>
</tr>
<tr>
<td style="text-align:center">[^…]</td>
<td style="text-align:center">负值字符集合。匹配未包含的任意字符。例如， ‘[^abc]’ 可以匹配 “plain” 中的’p’。</td>
</tr>
<tr>
<td style="text-align:center">p1｜p2｜p3</td>
<td style="text-align:center">匹配 p1 或 p2 或 p3。例如，’z｜food’ 能匹配 “z” 或 “food”。’(z｜f)ood’ 则匹配 “zood” 或 “food”。</td>
</tr>
<tr>
<td style="text-align:center">*</td>
<td style="text-align:center">匹配前面的子表达式零次或多次。例如，zo<em> 能匹配 “z” 以及 “zoo”。</em> 等价于{0,}。</td>
</tr>
<tr>
<td style="text-align:center">+</td>
<td style="text-align:center">匹配前面的子表达式一次或多次。例如，’zo+’ 能匹配 “zo” 以及 “zoo”，但不能匹配 “z”。+ 等价于 {1,}。</td>
</tr>
<tr>
<td style="text-align:center">{n}</td>
<td style="text-align:center">n 是一个非负整数。匹配确定的 n 次。例如，’o{2}’ 不能匹配 “Bob” 中的 ‘o’，但是能匹配 “food” 中的两个 o。</td>
</tr>
<tr>
<td style="text-align:center">{n,m}</td>
<td style="text-align:center">m 和 n 均为非负整数，其中n &lt;= m。最少匹配 n 次且最多匹配 m 次。</td>
</tr>
</tbody>
</table>
<h4 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h4><p><strong>设置隔离级别</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">查看当前会话隔离级别:</span><br><span class="line"><span class="keyword">select</span> @@tx_isolation;</span><br><span class="line">查看系统的隔离级别:</span><br><span class="line"><span class="keyword">select</span> @@global.tx_isolation;</span><br><span class="line">设置会话的隔离级别，隔离级别由低到高设置依次为:</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">session</span> <span class="keyword">transaction</span> <span class="keyword">isolation</span> <span class="keyword">level</span> <span class="keyword">read</span> uncommitted;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">session</span> <span class="keyword">transaction</span> <span class="keyword">isolation</span> <span class="keyword">level</span> <span class="keyword">read</span> committed;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">session</span> <span class="keyword">transaction</span> <span class="keyword">isolation</span> <span class="keyword">level</span> repeatable <span class="keyword">read</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">session</span> <span class="keyword">transaction</span> <span class="keyword">isolation</span> <span class="keyword">level</span> <span class="keyword">serializable</span>;</span><br><span class="line">设置当前系统的隔离级别，隔离级别由低到高设置依次为:</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> <span class="keyword">transaction</span> <span class="keyword">isolation</span> <span class="keyword">level</span> <span class="keyword">read</span> uncommitted;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> <span class="keyword">transaction</span> <span class="keyword">isolation</span> <span class="keyword">level</span> <span class="keyword">read</span> committed;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> <span class="keyword">transaction</span> <span class="keyword">isolation</span> <span class="keyword">level</span> repeatable <span class="keyword">read</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> <span class="keyword">transaction</span> <span class="keyword">isolation</span> <span class="keyword">level</span> <span class="keyword">serializable</span>;</span><br></pre></td></tr></table></figure>
<p><strong>事务控制语句</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1、用 <span class="keyword">BEGIN</span>, <span class="keyword">ROLLBACK</span>, <span class="keyword">COMMIT</span>来实现</span><br><span class="line"><span class="keyword">BEGIN</span> 开始一个事务</span><br><span class="line"><span class="keyword">ROLLBACK</span> 事务回滚</span><br><span class="line"><span class="keyword">COMMIT</span> 事务确认</span><br><span class="line"><span class="number">2</span>、直接用 <span class="keyword">SET</span> 来改变 MySQL 的自动提交模式:</span><br><span class="line"><span class="keyword">SET</span> AUTOCOMMIT=<span class="number">0</span> 禁止自动提交</span><br><span class="line"><span class="keyword">SET</span> AUTOCOMMIT=<span class="number">1</span> 开启自动提交</span><br><span class="line"><span class="number">3</span>、保存点</span><br><span class="line"><span class="keyword">SAVEPOINT</span> identifier，<span class="keyword">SAVEPOINT</span> 允许在事务中创建一个保存点，一个事务中可以有多个 <span class="keyword">SAVEPOINT</span>；</span><br><span class="line"><span class="keyword">RELEASE</span> <span class="keyword">SAVEPOINT</span> identifier 删除一个事务的保存点，当没有指定的保存点时，执行该语句会抛出一个异常；</span><br><span class="line"><span class="keyword">ROLLBACK</span> <span class="keyword">TO</span> identifier 把事务回滚到标记点；</span><br></pre></td></tr></table></figure>
<h4 id="ALTER-命令"><a href="#ALTER-命令" class="headerlink" title="ALTER 命令"></a>ALTER 命令</h4><ul>
<li>查看表字段</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">COLUMNS</span> <span class="keyword">FROM</span> testalter_tbl;</span><br></pre></td></tr></table></figure>
<ul>
<li>添加表字段</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> runoob_1 </span><br><span class="line"><span class="keyword">ADD</span> i <span class="built_in">INT</span> <span class="keyword">AFTER</span> runoob_id;</span><br></pre></td></tr></table></figure>
<p> 可以将AFTER runoob_id改为FIRST，插入到第一列，默认是末尾。</p>
<ul>
<li>删除表字段</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> testalter_tbl </span><br><span class="line"><span class="keyword">DROP</span> i;</span><br></pre></td></tr></table></figure>
<ul>
<li>MODIFY修改表字段</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> testalter_tbl </span><br><span class="line"><span class="keyword">MODIFY</span> c <span class="built_in">CHAR</span>(<span class="number">10</span>);</span><br><span class="line">#修改字段位置</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="keyword">test</span></span><br><span class="line"><span class="keyword">MODIFY</span> name1 type1 <span class="keyword">AFTER</span> name2;</span><br></pre></td></tr></table></figure>
<ul>
<li>CHANGE修改表字段</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> testalter_tbl </span><br><span class="line"><span class="keyword">CHANGE</span> i j <span class="built_in">BIGINT</span>;</span><br></pre></td></tr></table></figure>
<p> CHANGE 关键字之后，紧跟着的是你要修改的字段名，然后指定新字段名及类型。</p>
<ul>
<li>修改字段默认值</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> testalter_tbl </span><br><span class="line"><span class="keyword">ALTER</span> i <span class="keyword">SET</span> <span class="keyword">DEFAULT</span> <span class="number">1000</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>修改表名</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> testalter_tbl </span><br><span class="line"><span class="keyword">RENAME</span> <span class="keyword">TO</span> alter_tbl;</span><br></pre></td></tr></table></figure>
<ul>
<li>查看表属性</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">TABLE</span> <span class="keyword">STATUS</span> <span class="keyword">LIKE</span> <span class="string">'testalter_tbl'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>修改表属性</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> testalter_tbl </span><br><span class="line"><span class="keyword">ENGINE</span> = MYISAM;</span><br></pre></td></tr></table></figure>
<ul>
<li>删除外键约束</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> talbename</span><br><span class="line"><span class="keyword">DROP</span> FOREIGN <span class="keyword">KEY</span> keyname;</span><br></pre></td></tr></table></figure>
<h4 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h4><ul>
<li>查看索引</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">INDEX</span> <span class="keyword">FROM</span> table_name;</span><br></pre></td></tr></table></figure>
<ul>
<li>ALTER添加索引</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#添加普通索引，索引值可出现多次。</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tbl_name <span class="keyword">ADD</span> <span class="keyword">INDEX</span> index_name (column_list);</span><br><span class="line">#添加唯一索引，创建索引的值必须是唯一的（除了NULL外，NULL可能会出现多次）。</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tbl_name <span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> index_name (column_list);</span><br><span class="line">#添加全文索引</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tbl_name <span class="keyword">ADD</span> FULLTEXT index_name (column_list);</span><br></pre></td></tr></table></figure>
<ul>
<li>ALTER删除索引</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tbl_name <span class="keyword">DROP</span> <span class="keyword">INDEX</span> index_name;</span><br></pre></td></tr></table></figure>
<ul>
<li>ALTER添加删除主键</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#添加主键，首先确保主键列不为空。</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> testalter_tbl <span class="keyword">MODIFY</span> i <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tbl_name <span class="keyword">ADD</span> PRIMARY <span class="keyword">KEY</span> (column_list);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> testalter_tbl <span class="keyword">DROP</span> PRIMARY <span class="keyword">KEY</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>CREATE创建索引</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> indexName <span class="keyword">ON</span> table_name (column_name);</span><br></pre></td></tr></table></figure>
<ul>
<li>DROP删除索引</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">INDEX</span> [indexName] <span class="keyword">ON</span> table_name;</span><br></pre></td></tr></table></figure>
<ul>
<li>创建表时指定索引</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> mytable(</span><br><span class="line">    <span class="keyword">ID</span> <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,   </span><br><span class="line">    username <span class="built_in">VARCHAR</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,  </span><br><span class="line">    <span class="keyword">INDEX</span> [indexName] (username(<span class="keyword">length</span>))  </span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="临时表"><a href="#临时表" class="headerlink" title="临时表"></a>临时表</h4><ul>
<li>临时表创建、插入、删除。(无法通过show tables查看)</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TEMPORARY</span> <span class="keyword">TABLE</span> SalesSummary (</span><br><span class="line">    product_name <span class="built_in">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    total_sales <span class="built_in">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0.00</span>,</span><br><span class="line">    avg_unit_price <span class="built_in">DECIMAL</span>(<span class="number">7</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0.00</span>,</span><br><span class="line">    total_units_sold <span class="built_in">INT</span> <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> SalesSummary</span><br><span class="line">(product_name, total_sales, avg_unit_price, total_units_sold)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">(<span class="string">'cucumber'</span>, <span class="number">100.25</span>, <span class="number">90</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> SalesSummary;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> SalesSummary;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> SalesSummary;</span><br></pre></td></tr></table></figure>
<ul>
<li>用查询直接创建临时表</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TEMPORARY</span> <span class="keyword">TABLE</span> aaa <span class="keyword">AS</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> runoob_1</span><br><span class="line">    <span class="keyword">LIMIT</span> <span class="number">1</span>,<span class="number">10000</span> </span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="复制表"><a href="#复制表" class="headerlink" title="复制表"></a>复制表</h4><p><strong>法一：执行sql创建新表、再插入数据</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#输出该表的创建语句</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> runoob_tbl \G;</span><br><span class="line">#修改表名，然后执行sql语句</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`clone_tbl`</span> (</span><br><span class="line">    <span class="string">`runoob_id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> auto_increment,</span><br><span class="line">    <span class="string">`runoob_title`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">default</span> <span class="string">''</span>,</span><br><span class="line">    <span class="string">`runoob_author`</span> <span class="built_in">varchar</span>(<span class="number">40</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">default</span> <span class="string">''</span>,</span><br><span class="line">    <span class="string">`submission_date`</span> <span class="built_in">date</span> <span class="keyword">default</span> <span class="literal">NULL</span>,</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span>  (<span class="string">`runoob_id`</span>),</span><br><span class="line">    <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`AUTHOR_INDEX`</span> (<span class="string">`runoob_author`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span>;</span><br><span class="line">#将原表数据插入到新表</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> clone_tbl (runoob_id,runoob_title,runoob_author,submission_date)</span><br><span class="line"><span class="keyword">SELECT</span> runoob_id,runoob_title,runoob_author,submission_date <span class="keyword">FROM</span> runoob_tbl;</span><br></pre></td></tr></table></figure>
<p><strong>法二：复制表结构、再插入数据</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> targetTable <span class="keyword">LIKE</span> sourceTable;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> targetTable <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> sourceTable;</span><br></pre></td></tr></table></figure>
<p><strong>法三：复制表结构和数据</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> new_name <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> old_name;</span><br></pre></td></tr></table></figure>
<p><strong>创建新表并修改字段名</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> newadmin(</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">id</span>, username <span class="keyword">AS</span> uname, <span class="keyword">password</span> <span class="keyword">AS</span> pass <span class="keyword">FROM</span> <span class="keyword">admin</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="获取服务器原数据"><a href="#获取服务器原数据" class="headerlink" title="获取服务器原数据"></a>获取服务器原数据</h4><table>
<thead>
<tr>
<th style="text-align:center">SELECT VERSION( )</th>
<th style="text-align:center">服务器版本信息</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">SELECT DATABASE( )</td>
<td style="text-align:center">当前数据库名 (或者返回空)</td>
</tr>
<tr>
<td style="text-align:center">SELECT USER( )</td>
<td style="text-align:center">当前用户名</td>
</tr>
<tr>
<td style="text-align:center">SHOW STATUS</td>
<td style="text-align:center">服务器状态</td>
</tr>
<tr>
<td style="text-align:center">SHOW VARIABLES</td>
<td style="text-align:center">服务器配置变量</td>
</tr>
</tbody>
</table>
<h4 id="删除重复数据"><a href="#删除重复数据" class="headerlink" title="删除重复数据"></a>删除重复数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> tmp</span><br><span class="line"><span class="keyword">SELECT</span> last_name, first_name, sex <span class="keyword">FROM</span> person_tbl  </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> (last_name, first_name, sex);</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> person_tbl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tmp <span class="keyword">RENAME</span> <span class="keyword">TO</span> person_tbl;</span><br></pre></td></tr></table></figure>
<h4 id="导入导出数据"><a href="#导入导出数据" class="headerlink" title="导入导出数据"></a>导入导出数据</h4><p><strong>导出数据</strong></p>
<ul>
<li>查看数据库默认文件路径</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'datadir'</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>导出数据表数据</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">INTO</span> <span class="keyword">OUTFILE</span> <span class="string">'table.txt'</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>指定格式导出表数据</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a,b,a+b <span class="keyword">INTO</span> <span class="keyword">OUTFILE</span> <span class="string">'/tmp/result.text'</span></span><br><span class="line"><span class="keyword">FIELDS</span> <span class="keyword">TERMINATED</span> <span class="keyword">BY</span> <span class="string">','</span> <span class="keyword">OPTIONALLY</span> <span class="keyword">ENCLOSED</span> <span class="keyword">BY</span> <span class="string">'"'</span></span><br><span class="line"><span class="keyword">LINES</span> <span class="keyword">TERMINATED</span> <span class="keyword">BY</span> <span class="string">'\n'</span></span><br><span class="line"><span class="keyword">FROM</span> test_table;</span><br></pre></td></tr></table></figure>
<ul>
<li>mysqldump导出表sql</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -proot 数据库名 数据表名 &gt; tmp.txt</span><br></pre></td></tr></table></figure>
<ul>
<li>mysqldump导出数据库sql</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#导出数据库</span><br><span class="line">mysqldump -uroot -proot 数据库名 &gt; tmp.txt</span><br><span class="line">#导入数据库(库名要先手动创建)</span><br><span class="line">mysql -u root -p database_name &lt; tmp.txt</span><br></pre></td></tr></table></figure>
<ul>
<li>备份所有数据库</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -u root -p <span class="comment">--all-databases &gt; database_dump.txt</span></span><br></pre></td></tr></table></figure>
<ul>
<li>备份远程数据库</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -h other-host.com -P port -u root -p database_name &gt; dump.txt</span><br></pre></td></tr></table></figure>
<p><strong>导入数据</strong></p>
<ul>
<li>导入库sql</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#导入数据库(库名要先手动创建)</span><br><span class="line">mysql -u root -p database_name &lt; tmp.txt</span><br></pre></td></tr></table></figure>
<ul>
<li>source导入sql</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> abc;</span><br><span class="line"><span class="keyword">USE</span> abc;</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">NAMES</span> utf8;</span><br><span class="line">SOURCE /tmp/tmp.txt</span><br></pre></td></tr></table></figure>
<ul>
<li>LOAD DATA导入数据</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LOAD</span> <span class="keyword">DATA</span> <span class="keyword">LOCAL</span> <span class="keyword">INFILE</span> <span class="string">'dump.txt'</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span> mytbl;</span><br></pre></td></tr></table></figure>
<h3 id="LeetCode题解"><a href="#LeetCode题解" class="headerlink" title="LeetCode题解"></a>LeetCode题解</h3><ul>
<li><a href="https://leetcode.com/problems/reformat-department-table/" target="_blank" rel="noopener">1179. Reformat Department Table</a><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># Write your MySQL query statement below</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>, </span><br><span class="line"><span class="keyword">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span>=<span class="string">'Jan'</span> <span class="keyword">then</span> revenue <span class="keyword">end</span>) <span class="keyword">as</span> Jan_Revenue,</span><br><span class="line"><span class="keyword">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span>=<span class="string">'Feb'</span> <span class="keyword">then</span> revenue <span class="keyword">end</span>) <span class="keyword">as</span> Feb_Revenue,</span><br><span class="line"><span class="keyword">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span>=<span class="string">'Mar'</span> <span class="keyword">then</span> revenue <span class="keyword">end</span>) <span class="keyword">as</span> Mar_Revenue,</span><br><span class="line"><span class="keyword">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span>=<span class="string">'Apr'</span> <span class="keyword">then</span> revenue <span class="keyword">end</span>) <span class="keyword">as</span> Apr_Revenue,</span><br><span class="line"><span class="keyword">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span>=<span class="string">'May'</span> <span class="keyword">then</span> revenue <span class="keyword">end</span>) <span class="keyword">as</span> May_Revenue,</span><br><span class="line"><span class="keyword">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span>=<span class="string">'Jun'</span> <span class="keyword">then</span> revenue <span class="keyword">end</span>) <span class="keyword">as</span> Jun_Revenue,</span><br><span class="line"><span class="keyword">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span>=<span class="string">'Jul'</span> <span class="keyword">then</span> revenue <span class="keyword">end</span>) <span class="keyword">as</span> Jul_Revenue,</span><br><span class="line"><span class="keyword">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span>=<span class="string">'Aug'</span> <span class="keyword">then</span> revenue <span class="keyword">end</span>) <span class="keyword">as</span> Aug_Revenue,</span><br><span class="line"><span class="keyword">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span>=<span class="string">'Sep'</span> <span class="keyword">then</span> revenue <span class="keyword">end</span>) <span class="keyword">as</span> Sep_Revenue,</span><br><span class="line"><span class="keyword">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span>=<span class="string">'Oct'</span> <span class="keyword">then</span> revenue <span class="keyword">end</span>) <span class="keyword">as</span> Oct_Revenue,</span><br><span class="line"><span class="keyword">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span>=<span class="string">'Nov'</span> <span class="keyword">then</span> revenue <span class="keyword">end</span>) <span class="keyword">as</span> Nov_Revenue,</span><br><span class="line"><span class="keyword">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="keyword">month</span>=<span class="string">'Dec'</span> <span class="keyword">then</span> revenue <span class="keyword">end</span>) <span class="keyword">as</span> Dec_Revenue</span><br><span class="line"><span class="keyword">from</span> department</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">id</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h3><h4 id="b树与b-树对比"><a href="#b树与b-树对比" class="headerlink" title="b树与b+树对比"></a>b树与b+树对比</h4><ul>
<li>b+树的非叶子结点存储数据，所有相对于b树的结点，b+树的非叶子结点可以存储更多的索引，这样b+树会更矮更宽。</li>
<li>b+树每次操作都是o(logn)时间复杂度，是稳定的，b树的时间复杂度在o(1)~o(logn)之间。</li>
<li>b+树的所有叶子结点被链表串起来，更适合范围查询。</li>
</ul>
<h4 id="为什么数据库普遍不用红黑树作索引"><a href="#为什么数据库普遍不用红黑树作索引" class="headerlink" title="为什么数据库普遍不用红黑树作索引"></a>为什么数据库普遍不用红黑树作索引</h4><ul>
<li>b+树的出度是m，红黑树是2.所以b+树更矮更宽，所以b+树有更少的查询次数。</li>
<li>磁盘有预读特性，每次会将相邻的磁盘块提前加载到内存。数据库采用b+树，可以在范围查询时速度更快，具有更少的磁盘io次数。</li>
<li>参考： <a href="https://blog.csdn.net/qq_29373285/article/details/88610654?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase" target="_blank" rel="noopener">https://blog.csdn.net/qq_29373285/article/details/88610654?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase</a></li>
</ul>
<h4 id="为什么数据库一般不用hash表作索引"><a href="#为什么数据库一般不用hash表作索引" class="headerlink" title="为什么数据库一般不用hash表作索引"></a>为什么数据库一般不用hash表作索引</h4><ul>
<li>hash表在单词查询是时间复杂度是o(1)，但是在范围查询时是o(n)，数据库经常需要范围查询。</li>
</ul>
<h4 id="STL为什么用红黑树实现map、set，不用平衡二叉树。"><a href="#STL为什么用红黑树实现map、set，不用平衡二叉树。" class="headerlink" title="STL为什么用红黑树实现map、set，不用平衡二叉树。"></a>STL为什么用红黑树实现map、set，不用平衡二叉树。</h4><ul>
<li>平衡二叉树维护树完全平衡，但是这样就给每次操作带来了较大的常数时间，所以采用大体上平衡的红黑树反而效率更高。</li>
</ul>
<h3 id="参考-1"><a href="#参考-1" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://github.com/CyC2018/CS-Notes" target="_blank" rel="noopener">CS-Notes</a></li>
<li><a href="https://www.runoob.com/mysql/mysql-tutorial.html" target="_blank" rel="noopener">Mysql菜鸟教程</a></li>
</ul>
<!-- 
category : ACM_Algorithm CTF C_Cpp JAVA Linux Linux_Kernel 
SQL Cryptography Life Reading Thought Summary Security Unknown Tools  
Network Qt Trusted_Computing English System_Programming Network_Programming
　　←全角空格
![keyboard](https://img-bter)   ←图片
[keyboard](https://img-bter)    ←超链接

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>–&gt;<br>欢迎与我分享你的看法。<br>转载请注明出处：<a href="http://taowusheng.cn/">http://taowusheng.cn/</a></p>
-->
      
    </div>
    <footer class="article-footer">
      <a data-url="http://taowusheng.cn/2020/07/21/20200721 基础知识_数据库/" data-id="cl9smuymp00oz9bois374kwvb" class="article-share-link">Share</a>
      
      
        <a href="/2020/07/21/20200721 基础知识_数据库/#comments" class="article-comment-link">
          <span class="post-comments-count valine-comment-count" data-xid="/2020/07/21/20200721 基础知识_数据库/" itemprop="commentCount"></span>
          Comments
        </a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Summary/">Summary</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/">mysql</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/08/02/20200802 基础知识_Cpp/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          基础知识_Cpp
        
      </div>
    </a>
  
  
    <a href="/2020/07/20/20200720 基础知识_设计模式/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">基础知识_设计模式</div>
    </a>
  
</nav>

  
</article>



  <section id="comments" class="vcomment">

  </section>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ACM-Algorithm/">ACM_Algorithm</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Assembly/">Assembly</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/C-Cpp/">C_Cpp</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Cryptography/">Cryptography</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/English/">English</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Life/">Life</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux-Kernel/">Linux_Kernel</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Middleware/">Middleware</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Network/">Network</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Network-Programming/">Network_Programming</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Notes/">Notes</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Qt/">Qt</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Reading/">Reading</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Reading-Source/">Reading_Source</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SQL/">SQL</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Security/">Security</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Summary/">Summary</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/System-Programming/">System_Programming</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Thought/">Thought</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tools/">Tools</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Translation/">Translation</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Trusted-Computing/">Trusted_Computing</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Unknown/">Unknown</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/reading/">reading</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/01背包/" style="font-size: 10px;">01背包</a> <a href="/tags/2017/" style="font-size: 10px;">2017</a> <a href="/tags/2018/" style="font-size: 11.11px;">2018</a> <a href="/tags/2021/" style="font-size: 10px;">2021</a> <a href="/tags/ACM/" style="font-size: 13.33px;">ACM</a> <a href="/tags/ACM-Algorithm/" style="font-size: 10px;">ACM_Algorithm</a> <a href="/tags/Algorithm/" style="font-size: 10px;">Algorithm</a> <a href="/tags/Assembly/" style="font-size: 11.11px;">Assembly</a> <a href="/tags/C/" style="font-size: 11.11px;">C</a> <a href="/tags/C/" style="font-size: 12.22px;">C++</a> <a href="/tags/CTF/" style="font-size: 10px;">CTF</a> <a href="/tags/C-Cpp/" style="font-size: 12.22px;">C_Cpp</a> <a href="/tags/California-Dreaming/" style="font-size: 10px;">California_Dreaming</a> <a href="/tags/Cpp/" style="font-size: 14.44px;">Cpp</a> <a href="/tags/DES/" style="font-size: 10px;">DES</a> <a href="/tags/EDK/" style="font-size: 10px;">EDK</a> <a href="/tags/Effective-Cpp/" style="font-size: 10px;">Effective_Cpp</a> <a href="/tags/English/" style="font-size: 11.11px;">English</a> <a href="/tags/GMP/" style="font-size: 10px;">GMP</a> <a href="/tags/GUI/" style="font-size: 10px;">GUI</a> <a href="/tags/IO/" style="font-size: 10px;">IO</a> <a href="/tags/IO复用/" style="font-size: 10px;">IO复用</a> <a href="/tags/IO多路复用/" style="font-size: 10px;">IO多路复用</a> <a href="/tags/JAVA/" style="font-size: 16.67px;">JAVA</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/JsonCpp/" style="font-size: 10px;">JsonCpp</a> <a href="/tags/KGDB/" style="font-size: 10px;">KGDB</a> <a href="/tags/LeetCode/" style="font-size: 10px;">LeetCode</a> <a href="/tags/Linux/" style="font-size: 13.33px;">Linux</a> <a href="/tags/Linux-Kernel/" style="font-size: 13.33px;">Linux_Kernel</a> <a href="/tags/Middleware/" style="font-size: 10px;">Middleware</a> <a href="/tags/Network/" style="font-size: 11.11px;">Network</a> <a href="/tags/Network-Programming/" style="font-size: 13.33px;">Network_Programming</a> <a href="/tags/Python/" style="font-size: 15.56px;">Python</a> <a href="/tags/Qt/" style="font-size: 10px;">Qt</a> <a href="/tags/RSA/" style="font-size: 10px;">RSA</a> <a href="/tags/SELinux/" style="font-size: 10px;">SELinux</a> <a href="/tags/SHA/" style="font-size: 10px;">SHA</a> <a href="/tags/SQL/" style="font-size: 10px;">SQL</a> <a href="/tags/SSL/" style="font-size: 10px;">SSL</a> <a href="/tags/STL/" style="font-size: 14.44px;">STL</a> <a href="/tags/Security/" style="font-size: 10px;">Security</a> <a href="/tags/Summary/" style="font-size: 17.78px;">Summary</a> <a href="/tags/System-Programming/" style="font-size: 11.11px;">System_Programming</a> <a href="/tags/TSS/" style="font-size: 10px;">TSS</a> <a href="/tags/Thread/" style="font-size: 10px;">Thread</a> <a href="/tags/Tools/" style="font-size: 10px;">Tools</a> <a href="/tags/Translation/" style="font-size: 10px;">Translation</a> <a href="/tags/UDK/" style="font-size: 10px;">UDK</a> <a href="/tags/UDP/" style="font-size: 10px;">UDP</a> <a href="/tags/UEFI/" style="font-size: 10px;">UEFI</a> <a href="/tags/VMware/" style="font-size: 11.11px;">VMware</a> <a href="/tags/apt/" style="font-size: 10px;">apt</a> <a href="/tags/audit2allow/" style="font-size: 10px;">audit2allow</a> <a href="/tags/auth/" style="font-size: 10px;">auth</a> <a href="/tags/bellman/" style="font-size: 10px;">bellman</a> <a href="/tags/bitmap/" style="font-size: 10px;">bitmap</a> <a href="/tags/bjut/" style="font-size: 10px;">bjut</a> <a href="/tags/c/" style="font-size: 10px;">c++</a> <a href="/tags/concept/" style="font-size: 12.22px;">concept</a> <a href="/tags/cpp/" style="font-size: 15.56px;">cpp</a> <a href="/tags/cryptography/" style="font-size: 11.11px;">cryptography</a> <a href="/tags/curses/" style="font-size: 10px;">curses</a> <a href="/tags/deque/" style="font-size: 10px;">deque</a> <a href="/tags/dijkstra/" style="font-size: 10px;">dijkstra</a> <a href="/tags/dpkg/" style="font-size: 10px;">dpkg</a> <a href="/tags/echo/" style="font-size: 10px;">echo</a> <a href="/tags/emulator/" style="font-size: 10px;">emulator</a> <a href="/tags/english/" style="font-size: 12.22px;">english</a> <a href="/tags/epoll/" style="font-size: 10px;">epoll</a> <a href="/tags/floyd/" style="font-size: 10px;">floyd</a> <a href="/tags/g/" style="font-size: 10px;">g++</a> <a href="/tags/gcc/" style="font-size: 10px;">gcc</a> <a href="/tags/gdb/" style="font-size: 11.11px;">gdb</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/ip/" style="font-size: 11.11px;">ip</a> <a href="/tags/jdbc/" style="font-size: 10px;">jdbc</a> <a href="/tags/kernal/" style="font-size: 10px;">kernal</a> <a href="/tags/life/" style="font-size: 10px;">life</a> <a href="/tags/linus/" style="font-size: 10px;">linus</a> <a href="/tags/linux/" style="font-size: 18.89px;">linux</a> <a href="/tags/linux内核/" style="font-size: 10px;">linux内核</a> <a href="/tags/list/" style="font-size: 10px;">list</a> <a href="/tags/mail服务器/" style="font-size: 10px;">mail服务器</a> <a href="/tags/map/" style="font-size: 11.11px;">map</a> <a href="/tags/md5注入/" style="font-size: 10px;">md5注入</a> <a href="/tags/memory/" style="font-size: 10px;">memory</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/new/" style="font-size: 12.22px;">new</a> <a href="/tags/notes/" style="font-size: 12.22px;">notes</a> <a href="/tags/openstack/" style="font-size: 10px;">openstack</a> <a href="/tags/pam/" style="font-size: 10px;">pam</a> <a href="/tags/patch/" style="font-size: 10px;">patch</a> <a href="/tags/ping/" style="font-size: 10px;">ping</a> <a href="/tags/pip/" style="font-size: 10px;">pip</a> <a href="/tags/poll/" style="font-size: 10px;">poll</a> <a href="/tags/postfix/" style="font-size: 10px;">postfix</a> <a href="/tags/protobuf/" style="font-size: 10px;">protobuf</a> <a href="/tags/qemu/" style="font-size: 10px;">qemu</a> <a href="/tags/queue/" style="font-size: 10px;">queue</a> <a href="/tags/reading/" style="font-size: 20px;">reading</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/rodata/" style="font-size: 10px;">rodata</a> <a href="/tags/select/" style="font-size: 10px;">select</a> <a href="/tags/selinux/" style="font-size: 10px;">selinux</a> <a href="/tags/set/" style="font-size: 10px;">set</a> <a href="/tags/stack/" style="font-size: 10px;">stack</a> <a href="/tags/thought/" style="font-size: 12.22px;">thought</a> <a href="/tags/tinythhpd/" style="font-size: 10px;">tinythhpd</a> <a href="/tags/tinyxml/" style="font-size: 10px;">tinyxml</a> <a href="/tags/tools/" style="font-size: 12.22px;">tools</a> <a href="/tags/tpm/" style="font-size: 10px;">tpm</a> <a href="/tags/traits/" style="font-size: 10px;">traits</a> <a href="/tags/trousers/" style="font-size: 10px;">trousers</a> <a href="/tags/trusted-computing/" style="font-size: 10px;">trusted_computing</a> <a href="/tags/unix编程实践/" style="font-size: 10px;">unix编程实践</a> <a href="/tags/valgrind/" style="font-size: 10px;">valgrind</a> <a href="/tags/vector/" style="font-size: 10px;">vector</a> <a href="/tags/vim/" style="font-size: 10px;">vim</a> <a href="/tags/vs2013/" style="font-size: 10px;">vs2013</a> <a href="/tags/web/" style="font-size: 10px;">web</a> <a href="/tags/web服务器/" style="font-size: 10px;">web服务器</a> <a href="/tags/win10/" style="font-size: 10px;">win10</a> <a href="/tags/xml/" style="font-size: 10px;">xml</a> <a href="/tags/yum/" style="font-size: 10px;">yum</a> <a href="/tags/世界上最遥远的距离/" style="font-size: 10px;">世界上最遥远的距离</a> <a href="/tags/个人成长/" style="font-size: 11.11px;">个人成长</a> <a href="/tags/书单/" style="font-size: 12.22px;">书单</a> <a href="/tags/书摘/" style="font-size: 10px;">书摘</a> <a href="/tags/事件驱动/" style="font-size: 10px;">事件驱动</a> <a href="/tags/产品/" style="font-size: 10px;">产品</a> <a href="/tags/代码段/" style="font-size: 10px;">代码段</a> <a href="/tags/优先级/" style="font-size: 10px;">优先级</a> <a href="/tags/位向量/" style="font-size: 10px;">位向量</a> <a href="/tags/位图/" style="font-size: 10px;">位图</a> <a href="/tags/信号/" style="font-size: 10px;">信号</a> <a href="/tags/公钥/" style="font-size: 10px;">公钥</a> <a href="/tags/公钥密码/" style="font-size: 10px;">公钥密码</a> <a href="/tags/内存池/" style="font-size: 10px;">内存池</a> <a href="/tags/内存泄漏/" style="font-size: 10px;">内存泄漏</a> <a href="/tags/内存管理/" style="font-size: 10px;">内存管理</a> <a href="/tags/内核/" style="font-size: 10px;">内核</a> <a href="/tags/内核模块/" style="font-size: 10px;">内核模块</a> <a href="/tags/刘未鹏/" style="font-size: 11.11px;">刘未鹏</a> <a href="/tags/动态规划/" style="font-size: 10px;">动态规划</a> <a href="/tags/区间和/" style="font-size: 10px;">区间和</a> <a href="/tags/单例模式/" style="font-size: 10px;">单例模式</a> <a href="/tags/参考策略/" style="font-size: 10px;">参考策略</a> <a href="/tags/可信计算/" style="font-size: 11.11px;">可信计算</a> <a href="/tags/后台开发/" style="font-size: 10px;">后台开发</a> <a href="/tags/回显服务器/" style="font-size: 10px;">回显服务器</a> <a href="/tags/多线程/" style="font-size: 10px;">多线程</a> <a href="/tags/学习之路/" style="font-size: 10px;">学习之路</a> <a href="/tags/学习计划/" style="font-size: 10px;">学习计划</a> <a href="/tags/容器/" style="font-size: 10px;">容器</a> <a href="/tags/密码体制/" style="font-size: 10px;">密码体制</a> <a href="/tags/密码学/" style="font-size: 12.22px;">密码学</a> <a href="/tags/富爸爸穷爸爸/" style="font-size: 10px;">富爸爸穷爸爸</a> <a href="/tags/对称密码/" style="font-size: 10px;">对称密码</a> <a href="/tags/川藏线/" style="font-size: 10px;">川藏线</a> <a href="/tags/年终总结/" style="font-size: 13.33px;">年终总结</a> <a href="/tags/广告/" style="font-size: 10px;">广告</a> <a href="/tags/异常处理/" style="font-size: 10px;">异常处理</a> <a href="/tags/异步/" style="font-size: 10px;">异步</a> <a href="/tags/心智/" style="font-size: 10px;">心智</a> <a href="/tags/心理学/" style="font-size: 10px;">心理学</a> <a href="/tags/思维导图/" style="font-size: 10px;">思维导图</a> <a href="/tags/思考/" style="font-size: 12.22px;">思考</a> <a href="/tags/总结/" style="font-size: 15.56px;">总结</a> <a href="/tags/我是一只IT小小鸟/" style="font-size: 10px;">我是一只IT小小鸟</a> <a href="/tags/投资/" style="font-size: 10px;">投资</a> <a href="/tags/投资理财/" style="font-size: 11.11px;">投资理财</a> <a href="/tags/指数基金/" style="font-size: 10px;">指数基金</a> <a href="/tags/挑战程序设计竞赛/" style="font-size: 11.11px;">挑战程序设计竞赛</a> <a href="/tags/提问的智慧/" style="font-size: 10px;">提问的智慧</a> <a href="/tags/搜索/" style="font-size: 10px;">搜索</a> <a href="/tags/摄影/" style="font-size: 11.11px;">摄影</a> <a href="/tags/操作系统/" style="font-size: 10px;">操作系统</a> <a href="/tags/数据库/" style="font-size: 12.22px;">数据库</a> <a href="/tags/文本查询/" style="font-size: 10px;">文本查询</a> <a href="/tags/暗时间/" style="font-size: 10px;">暗时间</a> <a href="/tags/最短路径算法/" style="font-size: 10px;">最短路径算法</a> <a href="/tags/析构函数/" style="font-size: 10px;">析构函数</a> <a href="/tags/查理芒格/" style="font-size: 10px;">查理芒格</a> <a href="/tags/毕业旅行/" style="font-size: 10px;">毕业旅行</a> <a href="/tags/汇编/" style="font-size: 10px;">汇编</a> <a href="/tags/汇编语言/" style="font-size: 10px;">汇编语言</a> <a href="/tags/源码阅读/" style="font-size: 12.22px;">源码阅读</a> <a href="/tags/爬虫/" style="font-size: 10px;">爬虫</a> <a href="/tags/理财/" style="font-size: 10px;">理财</a> <a href="/tags/生活随笔/" style="font-size: 10px;">生活随笔</a> <a href="/tags/知识点/" style="font-size: 10px;">知识点</a> <a href="/tags/碎碎念/" style="font-size: 10px;">碎碎念</a> <a href="/tags/私钥/" style="font-size: 10px;">私钥</a> <a href="/tags/秋招/" style="font-size: 10px;">秋招</a> <a href="/tags/程序员/" style="font-size: 11.11px;">程序员</a> <a href="/tags/立flag/" style="font-size: 10px;">立flag</a> <a href="/tags/笔记/" style="font-size: 10px;">笔记</a> <a href="/tags/笔试/" style="font-size: 10px;">笔试</a> <a href="/tags/算法/" style="font-size: 11.11px;">算法</a> <a href="/tags/算法题/" style="font-size: 10px;">算法题</a> <a href="/tags/系统编程/" style="font-size: 11.11px;">系统编程</a> <a href="/tags/红黑树/" style="font-size: 10px;">红黑树</a> <a href="/tags/线段树/" style="font-size: 10px;">线段树</a> <a href="/tags/线程池/" style="font-size: 10px;">线程池</a> <a href="/tags/经历/" style="font-size: 10px;">经历</a> <a href="/tags/网络编程/" style="font-size: 12.22px;">网络编程</a> <a href="/tags/翻译/" style="font-size: 10px;">翻译</a> <a href="/tags/考研/" style="font-size: 10px;">考研</a> <a href="/tags/虚函数/" style="font-size: 10px;">虚函数</a> <a href="/tags/虚基类/" style="font-size: 10px;">虚基类</a> <a href="/tags/计划/" style="font-size: 10px;">计划</a> <a href="/tags/计时器/" style="font-size: 10px;">计时器</a> <a href="/tags/计算机/" style="font-size: 10px;">计算机</a> <a href="/tags/计算机技术/" style="font-size: 10px;">计算机技术</a> <a href="/tags/计算机网络/" style="font-size: 10px;">计算机网络</a> <a href="/tags/设计模式/" style="font-size: 10px;">设计模式</a> <a href="/tags/读书/" style="font-size: 10px;">读书</a> <a href="/tags/读书笔记/" style="font-size: 13.33px;">读书笔记</a> <a href="/tags/调试/" style="font-size: 10px;">调试</a> <a href="/tags/进程/" style="font-size: 10px;">进程</a> <a href="/tags/重定向/" style="font-size: 10px;">重定向</a> <a href="/tags/阅读/" style="font-size: 10px;">阅读</a> <a href="/tags/阻塞/" style="font-size: 10px;">阻塞</a> <a href="/tags/面向对象/" style="font-size: 11.11px;">面向对象</a> <a href="/tags/面向过程/" style="font-size: 10px;">面向过程</a> <a href="/tags/预处理/" style="font-size: 10px;">预处理</a> <a href="/tags/骑行/" style="font-size: 10px;">骑行</a> <a href="/tags/黑客与画家/" style="font-size: 10px;">黑客与画家</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2029/11/">November 2029</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">May 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2029/11/11/20291111 坚持阅读/">坚持阅读</a>
          </li>
        
          <li>
            <a href="/2022/10/27/20221027 北京香山公园一日游/">北京香山公园一日游</a>
          </li>
        
          <li>
            <a href="/2021/12/31/20211231 2021年终总结/">2021年终总结</a>
          </li>
        
          <li>
            <a href="/2021/10/11/20211011 我的毕业旅行/">我的毕业旅行</a>
          </li>
        
          <li>
            <a href="/2020/12/31/20201231 2020年终总结/">2020年终总结</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">visiters</h3>
    <div class="widget">
      <script type="text/javascript" src="//rf.revolvermaps.com/0/0/8.js?i=534a4dn9fi8&amp;m=0c&amp;c=ff0000&amp;cr1=ffffff&amp;f=ubuntu&amp;l=0&amp;cw=ffffff&amp;cb=000000" async="async"></script>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016-2021 Tao WuSheng<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/links" class="mobile-nav-link">Links</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>




  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script>
    var GUEST_INFO = ['nick','mail','link'];
    var guest_info = 'nick,mail,link'.split(',').filter(function(item){
        return GUEST_INFO.indexOf(item) > -1
    });
    var notify = 'true' == true;
    var verify = 'true' == true;
    new Valine({
        el: '.vcomment',
        notify: notify,
        verify: verify,
        appId: "IwNQge9YG0FIzuQKmRVrBgCL-gzGzoHsz",
        appKey: "IP8hmPLhobMvvjpkfm1OKzuv",
        placeholder: "Please leave your footprints...",
        pageSize:'10',
        avatar:'mm',
        lang:'zh-cn'
    });
</script>

  </div>
</body>
</html>